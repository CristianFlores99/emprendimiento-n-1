<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SPA Panel - Index</title>
  <style>
    :root{--bg:#f4f6fb;--card:#ffffff;--accent:#4f46e5;--muted:#6b7280;--success:#10b981}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;background:var(--bg);color:#111}
    .app{display:flex;min-height:100vh}
    /* Sidebar */
    .sidebar{width:260px;background:#0f172a;color:#fff;padding:20px;display:flex;flex-direction:column;gap:16px}
    .logo{font-weight:700;display:flex;align-items:center;gap:10px}
    .nav{display:flex;flex-direction:column;gap:6px;margin-top:10px}
    .nav a{color:rgba(255,255,255,0.8);text-decoration:none;padding:10px;border-radius:8px;display:flex;align-items:center;gap:10px}
    .nav a.active{background:rgba(255,255,255,0.06)}
    .nav a:hover{background:rgba(255,255,255,0.04)}
    .grow{flex:1}
    /* Main */
    .main{flex:1;padding:22px}
    .topbar{display:flex;justify-content:space-between;align-items:center;gap:16px;margin-bottom:18px}
    .card{background:var(--card);border-radius:12px;padding:16px;box-shadow:0 1px 4px rgba(2,6,23,0.06)}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;text-align:left;border-bottom:1px solid #eee}
    .btn{background:var(--accent);color:#fff;padding:8px 12px;border:none;border-radius:8px;cursor:pointer}
    .btn.ghost{background:transparent;color:var(--accent);border:1px solid rgba(79,70,229,0.12)}
    .small{font-size:13px;color:var(--muted)}

    /* Responsive */
    @media (max-width:800px){
      .sidebar{position:fixed;left:-320px;top:0;bottom:0;z-index:50;transition:left .2s}
      .sidebar.open{left:0}
      .main{padding:12px}
    }

    /* form */
    .field{display:flex;flex-direction:column;margin-bottom:10px}
    .field label{font-size:13px;color:var(--muted);margin-bottom:6px}
    .field input, .field textarea, .field select{padding:8px;border-radius:8px;border:1px solid #e6e9f2}

    /* modal */
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,0.45);display:flex;align-items:center;justify-content:center}
    .modal{background:var(--card);padding:18px;border-radius:12px;min-width:320px;max-width:720px}

  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar" id="sidebar">
      <div class="logo">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="18" rx="4" fill="white"/></svg>
        <div>
          <div style="font-size:16px">Mi Panel SPA</div>
          <div class="small">Dashboard ligero</div>
        </div>
      </div>

      <nav class="nav" id="nav">
        <a href="#/" data-route="/" class="active">üè† Dashboard</a>
        <a href="#/productos" data-route="/productos">üõí Productos</a>
        <a href="#/proveedores" data-route="/proveedores">üöö Proveedores</a>
        <a href="#/clientes" data-route="/clientes">üë• Clientes</a>
        <a href="#/config" data-route="/config">‚öôÔ∏è Configuraci√≥n</a>
      </nav>

      <div class="grow"></div>
      <div class="small">Versi√≥n demo ¬∑ Local</div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div style="display:flex;gap:12px;align-items:center">
          <button id="menuToggle" class="btn ghost" style="display:none">‚ò∞</button>
          <h2 id="pageTitle">Dashboard</h2>
        </div>
        <div style="display:flex;gap:10px;align-items:center">
          <div class="small">Usuario: Admin</div>
          <button id="addBtn" class="btn">Nuevo</button>
        </div>
      </div>

      <div id="view"></div>
    </main>
  </div>

  <!-- modal container -->
  <div id="modalRoot" style="display:none"></div>

  <script>
    /* --- Simple hash router and small SPA --- */
    const routes = {
      '/': renderDashboard,
      '/productos': renderProductos,
      '/proveedores': renderProveedores,
      '/clientes': renderClientes,
      '/config': renderConfig
    }

    // sample data in localStorage
    const LS_KEY = 'spa_panel_demo_v1'
    const defaultState = { productos:[
      {id:1,nombre:'Maceta cer√°mica',precio:1200,stock:8},
      {id:2,nombre:'Tierra para suculentas 5L',precio:650,stock:30}
    ], proveedores:[{id:1,nombre:'Vivero Flores',telefono:'123456789'}], clientes:[] }

    function loadState(){
      try{ const s = JSON.parse(localStorage.getItem(LS_KEY)); return s||defaultState }catch(e){return defaultState}
    }
    function saveState(s){ localStorage.setItem(LS_KEY, JSON.stringify(s)) }
    let state = loadState()

    // utils
    function $(sel,root=document){return root.querySelector(sel)}
    function createEl(tag,props={},...children){ const el=document.createElement(tag); for(const k in props){ if(k.startsWith('on') && typeof props[k]==='function') el.addEventListener(k.slice(2).toLowerCase(),props[k]); else el.setAttribute(k,props[k]) } children.flat().forEach(c=>{ if(typeof c==='string') el.appendChild(document.createTextNode(c)); else if(c) el.appendChild(c) }); return el }

    // routing
    function setActiveNav(path){ document.querySelectorAll('#nav a').forEach(a=> a.classList.toggle('active', a.getAttribute('data-route')===path)) }

    function navigate(){
      const hash = location.hash.replace('#','') || '/'
      const fn = routes[hash] || renderNotFound
      setActiveNav(hash)
      $('#pageTitle').textContent = hash === '/' ? 'Dashboard' : hash.replace('/','').charAt(0).toUpperCase()+hash.replace('/','').slice(1)
      fn()
    }

    window.addEventListener('hashchange', navigate)
    window.addEventListener('load', ()=>{ setupUI(); navigate(); })

    // top-level UI
    function setupUI(){
      const menuToggle = $('#menuToggle')
      if(menuToggle){ menuToggle.style.display='none' }
      $('#addBtn').addEventListener('click', ()=>{ const path = location.hash.replace('#','')||'/'; if(path==='/productos') openProductoModal(); else if(path==='/proveedores') openProveedorModal(); else alert('El bot√≥n Nuevo funciona en las secciones Productos y Proveedores.') })
      // responsive menu
      function check(){ if(window.innerWidth<=800) { $('#menuToggle').style.display='inline-block'; $('#menuToggle').addEventListener('click',()=> document.getElementById('sidebar').classList.toggle('open')) } }
      check(); window.addEventListener('resize', check)
    }

    /* --------- VIEWS ---------- */
    function renderDashboard(){
      const v = createEl('div',{},
        createEl('div',{class:'grid'},
          createEl('div',{class:'card'},
            createEl('h3',{},'Resumen rapido'),
            createEl('div',{class:'small'},`Productos: ${state.productos.length}`)
          ),
          createEl('div',{class:'card'},
            createEl('h3',{},'Inventario total'),
            createEl('div',{class:'small'},`${state.productos.reduce((a,b)=>a+b.stock,0)} items en stock`)
          )
        ),
        createEl('div',{style:'margin-top:12px'},
          createEl('div',{class:'card'},
            createEl('h3',{},'√öltimos productos'),
            renderProductosTable(5)
          )
        )
      )
      $('#view').innerHTML=''; $('#view').appendChild(v)
    }

    /* Productos */
    function renderProductos(){
      const v = createEl('div',{},
        createEl('div',{class:'card'},
          createEl('h3',{},'Productos'),
          renderProductosTable()
        )
      )
      $('#view').innerHTML=''; $('#view').appendChild(v)
    }

    function renderProductosTable(limit){
      const tbl = document.createElement('table')
      const thead = document.createElement('thead')
      thead.innerHTML = '<tr><th>Nombre</th><th>Precio</th><th>Stock</th><th></th></tr>'
      tbl.appendChild(thead)
      const tbody = document.createElement('tbody')
      const items = state.productos.slice().reverse()
      if(limit) items.splice(limit)
      items.forEach(p=>{
        const tr = document.createElement('tr')
        tr.innerHTML = `<td>${p.nombre}</td><td>$ ${p.precio}</td><td>${p.stock}</td><td style="text-align:right"></td>`
        const btns = createEl('div',{},
          createEl('button',{class:'btn ghost', onClick:()=>openProductoModal(p)},'Editar'),
          createEl('button',{class:'btn', onClick:()=>deleteProducto(p.id)},'Eliminar')
        )
        tr.querySelector('td:last-child').appendChild(btns)
        tbody.appendChild(tr)
      })
      tbl.appendChild(tbody)
      return tbl
    }

    function openProductoModal(product){
      const isEdit = !!product
      const root = $('#modalRoot'); root.style.display='block'; root.innerHTML=''
      const modal = createEl('div',{class:'modal-backdrop'}, createEl('div',{class:'modal'},
        createEl('h3',{}, isEdit ? 'Editar producto' : 'Nuevo producto'),
        createEl('div',{class:'field'}, createEl('label',{},'Nombre'), createEl('input',{id:'p_nombre', value: product ? product.nombre : ''})),
        createEl('div',{class:'field'}, createEl('label',{},'Precio'), createEl('input',{id:'p_precio', type:'number', value: product ? product.precio : 0})),
        createEl('div',{class:'field'}, createEl('label',{},'Stock'), createEl('input',{id:'p_stock', type:'number', value: product ? product.stock : 0})),
        createEl('div',{style:'display:flex;gap:8px;justify-content:flex-end;margin-top:8px'},
          createEl('button',{class:'btn ghost', onClick:closeModal},'Cancelar'),
          createEl('button',{class:'btn', onClick:()=>{ saveProducto(isEdit?product.id:null) } }, isEdit ? 'Guardar' : 'Crear')
        )
      ))
      root.appendChild(modal)
    }

    function closeModal(){ const root = $('#modalRoot'); root.style.display='none'; root.innerHTML='' }

    function saveProducto(id){ const nombre = $('#p_nombre').value.trim(); const precio = Number($('#p_precio').value)||0; const stock = Number($('#p_stock').value)||0; if(!nombre){alert('Nombre requerido');return}
      if(id){ state.productos = state.productos.map(p=> p.id===id ? {...p,nombre,precio,stock} : p) }
      else{ const nid = state.productos.reduce((a,b)=>Math.max(a,b.id),0)+1; state.productos.push({id:nid,nombre,precio,stock}) }
      saveState(state); closeModal(); renderProductos(); }

    function deleteProducto(id){ if(!confirm('Eliminar producto?')) return; state.productos = state.productos.filter(p=>p.id!==id); saveState(state); renderProductos(); }

    /* Proveedores */
    function renderProveedores(){
      const v = createEl('div',{}, createEl('div',{class:'card'}, createEl('h3',{},'Proveedores'), renderProveedoresTable() ))
      $('#view').innerHTML=''; $('#view').appendChild(v)
    }

    function renderProveedoresTable(){ const tbl=document.createElement('table'); tbl.innerHTML = `<thead><tr><th>Nombre</th><th>Tel√©fono</th><th></th></tr></thead>`; const tbody=document.createElement('tbody'); state.proveedores.forEach(p=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${p.nombre}</td><td>${p.telefono}</td><td style="text-align:right"></td>`; const btns=createEl('div',{}, createEl('button',{class:'btn ghost', onClick:()=>openProveedorModal(p)},'Editar'), createEl('button',{class:'btn', onClick:()=>deleteProveedor(p.id)},'Eliminar') ); tr.querySelector('td:last-child').appendChild(btns); tbody.appendChild(tr); }); tbl.appendChild(tbody); return tbl }

    function openProveedorModal(prov){ const isEdit=!!prov; const root=$('#modalRoot'); root.style.display='block'; root.innerHTML=''; const modal=createEl('div',{class:'modal-backdrop'}, createEl('div',{class:'modal'}, createEl('h3',{}, isEdit ? 'Editar proveedor' : 'Nuevo proveedor'), createEl('div',{class:'field'}, createEl('label',{},'Nombre'), createEl('input',{id:'prov_nombre', value:prov?prov.nombre:''})), createEl('div',{class:'field'}, createEl('label',{},'Tel√©fono'), createEl('input',{id:'prov_telefono', value:prov?prov.telefono:''})), createEl('div',{style:'display:flex;gap:8px;justify-content:flex-end;margin-top:8px'}, createEl('button',{class:'btn ghost', onClick:closeModal},'Cancelar'), createEl('button',{class:'btn', onClick:()=>{ saveProveedor(isEdit?prov.id:null) } }, isEdit ? 'Guardar' : 'Crear') ) )); root.appendChild(modal) }

    function saveProveedor(id){ const nombre=$('#prov_nombre').value.trim(); const telefono=$('#prov_telefono').value.trim(); if(!nombre){ alert('Nombre requerido'); return } if(id){ state.proveedores = state.proveedores.map(p=> p.id===id ? {...p,nombre,telefono} : p) } else { const nid = state.proveedores.reduce((a,b)=>Math.max(a,b.id),0)+1; state.proveedores.push({id:nid,nombre,telefono}) } saveState(state); closeModal(); renderProveedores(); }
    function deleteProveedor(id){ if(!confirm('Eliminar proveedor?')) return; state.proveedores = state.proveedores.filter(p=>p.id!==id); saveState(state); renderProveedores(); }

    /* Clientes (simple listado) */
    function renderClientes(){ const v=createEl('div',{}, createEl('div',{class:'card'}, createEl('h3',{},'Clientes (vac√≠o)'), createEl('div',{class:'small'},'Aqu√≠ podr√°s listar clientes y sus pedidos.'))); $('#view').innerHTML=''; $('#view').appendChild(v) }

    function renderConfig(){ const v=createEl('div',{}, createEl('div',{class:'card'}, createEl('h3',{},'Configuraci√≥n'), createEl('div',{class:'small'},'Opciones b√°sicas de la aplicaci√≥n (demo).'), createEl('div',{style:'margin-top:10px'}, createEl('button',{class:'btn ghost', onClick:()=>{ if(confirm('Restablecer datos demo?')){ localStorage.removeItem(LS_KEY); state=loadState(); navigate(); } } },'Restablecer datos')) )); $('#view').innerHTML=''; $('#view').appendChild(v) }

    function renderNotFound(){ $('#view').innerHTML='<div class="card"><h3>404</h3><p>Ruta no encontrada</p></div>' }

  </script>
</body>
</html>
